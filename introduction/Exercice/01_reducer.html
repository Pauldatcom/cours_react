<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Partie 2 ‚Äì useReducer</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
      line-height: 1.6;
      color: #333;
      background: #f5f5f5;
      padding: 20px;
    }
    
    .container {
      max-width: 1200px;
      margin: 0 auto;
      background: white;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      overflow: hidden;
    }
    
    header {
      background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
      color: white;
      padding: 30px;
      text-align: center;
    }
    
    header h1 {
      font-size: 2em;
      margin-bottom: 10px;
    }
    
    .content {
      padding: 30px;
    }
    
    .section {
      margin-bottom: 40px;
    }
    
    .section h2 {
      color: #4facfe;
      font-size: 1.8em;
      margin-bottom: 20px;
      padding-bottom: 10px;
      border-bottom: 3px solid #4facfe;
    }
    
    .section h3 {
      color: #00f2fe;
      font-size: 1.4em;
      margin: 25px 0 15px 0;
    }
    
    .section h4 {
      color: #555;
      font-size: 1.2em;
      margin: 20px 0 10px 0;
    }
    
    .demo-box {
      background: #1e293b;
      border-radius: 8px;
      padding: 20px;
      margin: 20px 0;
      border: 2px solid #3b82f6;
    }
    
    .explanation {
      background: #f8f9fa;
      border-left: 4px solid #4facfe;
      padding: 20px;
      margin: 20px 0;
      border-radius: 5px;
    }
    
    .explanation p {
      margin: 10px 0;
    }
    
    .explanation ul {
      margin: 10px 0 10px 20px;
    }
    
    .explanation li {
      margin: 8px 0;
    }
    
    .explanation ol {
      margin: 10px 0 10px 20px;
    }
    
    code {
      background: #f4f4f4;
      padding: 2px 6px;
      border-radius: 3px;
      font-family: 'Courier New', monospace;
      color: #e83e8c;
    }
    
    pre {
      background: #2d3748;
      color: #e2e8f0;
      padding: 15px;
      border-radius: 5px;
      overflow-x: auto;
      margin: 15px 0;
    }
    
    pre code {
      background: none;
      color: inherit;
      padding: 0;
    }
    
    .highlight {
      background: #d1ecf1;
      padding: 15px;
      border-left: 4px solid #4facfe;
      margin: 15px 0;
      border-radius: 5px;
    }
    
    .code-block {
      background: #f8f9fa;
      border: 1px solid #dee2e6;
      border-radius: 5px;
      padding: 15px;
      margin: 15px 0;
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>Exercice ‚Äì Calculatrice avec `useReducer`</h1>
      <p>Addition de deux nombres</p>
    </header>
    
    <div class="content">
      <div class="section">
        <h2>Code complet de l'exemple</h2>
        <p>Impl√©mentation d'une <strong>calculatrice simple</strong> utilisant le hook `useReducer` pour g√©rer l'addition de deux nombres. `useReducer` permet de g√©rer des √©tats complexes (inputs, r√©sultat, erreurs) de mani√®re plus structur√©e.</p>
        
        <div class="demo-box">
          <div id="root"></div>
        </div>
        
        <div class="code-block">
          <h4>Code JSX :</h4>
          <pre><code>import React, { useReducer } from "react";

// TypeScript type definitions
interface CalculatorState {
  a: string;
  b: string;
  result: number;
  error: string;
}

type CalculatorAction =
  | { type: "SET_A"; payload: string }
  | { type: "SET_B"; payload: string }
  | { type: "CALCULATE" }
  | { type: "RESET" };

// √âtat initial
const initialState: CalculatorState = {
  a: "",
  b: "",
  result: 0,
  error: ""
};

// Fonction reducer : g√®re les mises √† jour de l'√©tat en fonction du type d'action
function calculatorReducer(
  state: CalculatorState,
  action: CalculatorAction
): CalculatorState {
  switch (action.type) {
    case "SET_A":
      return { ...state, a: action.payload, error: "" };
    
    case "SET_B":
      return { ...state, b: action.payload, error: "" };
    
    case "CALCULATE":
      const numA: number = parseFloat(state.a);
      const numB: number = parseFloat(state.b);
      
      if (state.a === "" || state.b === "") {
        return { ...state, error: "Please enter both numbers" };
      }
      
      if (isNaN(numA) || isNaN(numB)) {
        return { ...state, error: "Please enter valid numbers" };
      }
      
      return { ...state, result: numA + numB, error: "" };
    
    case "RESET":
      return initialState;
    
    default:
      return state;
  }
}

export default function Calculator(): JSX.Element {
  const [state, dispatch]: [
    CalculatorState,
    React.Dispatch&lt;CalculatorAction&gt;
  ] = useReducer(calculatorReducer, initialState);

  return (
    &lt;div&gt;
      &lt;input 
        value={state.a} 
        onChange={(e: React.ChangeEvent&lt;HTMLInputElement&gt;) =&gt; {
          dispatch({ type: "SET_A", payload: e.target.value });
        }} 
      /&gt;
      &lt;span&gt; + &lt;/span&gt;
      &lt;input 
        value={state.b} 
        onChange={(e: React.ChangeEvent&lt;HTMLInputElement&gt;) =&gt; {
          dispatch({ type: "SET_B", payload: e.target.value });
        }} 
      /&gt;
      &lt;button onClick={() =&gt; dispatch({ type: "CALCULATE" })}&gt;Calculate&lt;/button&gt;
      &lt;p&gt;Result: {state.result}&lt;/p&gt;
      {state.error && &lt;p&gt;{state.error}&lt;/p&gt;}
    &lt;/div&gt;
  );
}</code></pre>
        </div>
      </div>
      
      <div class="section">
        <h2>üîç Explication simple de `useReducer`</h2>
        
        <div class="explanation">
          <h3>Qu'est-ce que `useReducer` ?</h3>
          <p>`useReducer` est une alternative √† `useState` pour g√©rer l'√©tat d'un composant. Au lieu de modifier directement l'√©tat avec `setCount(count + 1)`, on envoie une "action" comme `dispatch({ type: "INCREMENT" })` et une fonction `reducer` calcule le nouvel √©tat.</p>
        </div>
        
        <div class="explanation">
          <h3>Comment √ßa fonctionne ?</h3>
          <ol>
            <li><strong>La fonction `reducer`</strong> : Prend l'√©tat actuel et une action, retourne le nouvel √©tat selon le type d'action.</li>
            <li><strong>Le hook `useReducer`</strong> : Prend deux arguments (la fonction reducer et l'√©tat initial) et retourne l'√©tat actuel et la fonction `dispatch`.</li>
            <li><strong>La fonction `dispatch`</strong> : Permet d'envoyer une action au reducer (ex: `dispatch({ type: "SET_A", payload: "5" })` ou `dispatch({ type: "CALCULATE" })`).</li>
          </ol>
        </div>
        
        <div class="explanation">
          <h3>Exemple : Quand on clique sur "Calculate"</h3>
          <ol>
            <li>Le bouton appelle `dispatch({ type: "CALCULATE" })`</li>
            <li>Le reducer re√ßoit l'√©tat actuel (avec les valeurs de `a` et `b`) et l'action</li>
            <li>Le reducer valide les inputs et calcule le r√©sultat : `{ result: numA + numB }`</li>
            <li>Si une erreur est d√©tect√©e, elle est stock√©e dans `state.error`</li>
            <li>React met √† jour l'affichage automatiquement</li>
          </ol>
        </div>
        
        <div class="highlight">
          <strong>üí° Testez le code :</strong> Entrez deux nombres dans les champs et cliquez sur "Calculate" pour voir le reducer en action. Essayez aussi d'entrer des valeurs invalides pour voir la gestion d'erreur !
        </div>
      </div>
    </div>
  </div>

  <!-- React, ReactDOM et Babel -->
  <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>

  <script type="text/babel">
    // @ts-nocheck - TypeScript types are handled by Babel standalone
    const { useReducer } = React;

    // TypeScript type definitions
    interface CalculatorState {
      a: string;
      b: string;
      result: number;
      error: string;
    }

    type CalculatorAction =
      | { type: "SET_A"; payload: string }
      | { type: "SET_B"; payload: string }
      | { type: "CALCULATE" }
      | { type: "RESET" };

    const initialState: CalculatorState = {
      a: "",
      b: "",
      result: 0,
      error: ""
    };

    function calculatorReducer(
      state: CalculatorState,
      action: CalculatorAction
    ): CalculatorState {
      switch (action.type) {
        case "SET_A":
          return {
            ...state,
            a: action.payload,
            error: "" 
          };
        
        case "SET_B":
          return {
            ...state,
            b: action.payload,
            error: ""
          };
        
        case "CALCULATE":
          const numA: number = parseFloat(state.a);
          const numB: number = parseFloat(state.b);
          
          if (state.a === "" || state.b === "") {
            return {
              ...state,
              error: "Please enter both numbers"
            };
          }
          
          if (isNaN(numA) || isNaN(numB)) {
            return {
              ...state,
              error: "Please enter valid numbers"
            };
          }
          
          return {
            ...state,
            result: numA + numB,
            error: ""
          };
        
        case "RESET":
          return initialState;
        
        default:
          return state;
      }
    }

    function Calculator(): JSX.Element {
      const [state, dispatch]: [
        CalculatorState,
        React.Dispatch<CalculatorAction>
      ] = useReducer(calculatorReducer, initialState);

      const handleSubmit = (e: React.FormEvent<HTMLFormElement>): void => {
        e.preventDefault();
        dispatch({ type: "CALCULATE" });
      };

      return (
        <div className="bg-slate-800 p-8 rounded-xl shadow-2xl max-w-md mx-auto">
          <h2 className="text-3xl font-bold mb-6 text-center bg-gradient-to-r from-blue-400 to-purple-500 bg-clip-text text-transparent">
            Calculator
          </h2>
          
          <form onSubmit={handleSubmit} className="space-y-4">
            {/* First number input */}
            <div>
              <label className="block text-gray-300 text-sm font-semibold mb-2">
                First Number (a)
              </label>
              <input
                type="text"
                value={state.a}
                onChange={(e: React.ChangeEvent<HTMLInputElement>): void => {
                  dispatch({ type: "SET_A", payload: e.target.value });
                }}
                placeholder="Enter first number"
                className="w-full px-4 py-3 rounded-lg bg-slate-700 text-white border-2 border-slate-600 focus:border-blue-500 focus:outline-none transition-colors"
              />
            </div>

            {/* Plus sign */}
            <div className="text-center text-4xl text-blue-400 font-bold">
              +
            </div>

            {/* Second number input */}
            <div>
              <label className="block text-gray-300 text-sm font-semibold mb-2">
                Second Number (b)
              </label>
              <input
                type="text"
                value={state.b}
                onChange={(e: React.ChangeEvent<HTMLInputElement>): void => {
                  dispatch({ type: "SET_B", payload: e.target.value });
                }}
                placeholder="Enter second number"
                className="w-full px-4 py-3 rounded-lg bg-slate-700 text-white border-2 border-slate-600 focus:border-blue-500 focus:outline-none transition-colors"
              />
            </div>

            {/* Error message */}
            {state.error && (
              <div className="bg-red-600 text-white p-3 rounded-lg text-sm">
                ‚ö†Ô∏è {state.error}
              </div>
            )}

            {/* Result display */}
            <div className="bg-slate-700 rounded-lg p-6 text-center">
              <p className="text-sm text-gray-400 mb-2">Result</p>
              <p className="text-5xl font-bold text-blue-400">{state.result}</p>
            </div>

            {/* Action buttons */}
            <div className="flex gap-3">
              <button
                type="submit"
                className="flex-1 bg-blue-600 hover:bg-blue-700 active:scale-95 px-6 py-3 rounded-lg transition-all duration-200 font-semibold shadow-lg text-white"
              >
                Calculate
              </button>
              
              <button
                type="button"
                onClick={(e: React.MouseEvent<HTMLButtonElement>): void => {
                  e.preventDefault();
                  dispatch({ type: "RESET" });
                }}
                className="flex-1 bg-gray-600 hover:bg-gray-700 active:scale-95 px-6 py-3 rounded-lg transition-all duration-200 font-semibold shadow-lg text-white"
              >
                Reset
              </button>
            </div>
          </form>

          <div className="mt-6 p-4 bg-slate-700 rounded-lg text-sm text-gray-300">
            <p className="font-semibold mb-2">üí° How it works?</p>
            <ul className="list-disc list-inside space-y-1 text-xs">
              <li>Enter two numbers in the input fields</li>
              <li>Click "Calculate" to add them together</li>
              <li>The reducer handles validation and calculation</li>
              <li>Errors are displayed if inputs are invalid</li>
            </ul>
          </div>
        </div>
      );
    }

    ReactDOM.createRoot(document.getElementById("root")).render(<Calculator />);
  </script>
</body>
</html>
